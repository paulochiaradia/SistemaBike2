'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getRounds = undefined;
exports.genSalt = genSalt;
exports.hash = hash;
exports.compare = compare;

var _bluebird = require('bluebird');

var _bluebird2 = _interopRequireDefault(_bluebird);

var _bcrypt = require('bcrypt');

var _bcrypt2 = _interopRequireDefault(_bcrypt);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var bcryptP = _bluebird2.default.promisifyAll(_bcrypt2.default);

function genSalt(rounds) {
  return bcryptP.getSaltAsync(rounds);
}

function hash(data, salt) {
  return bcryptP.hashAsync(data, salt);
}

function compare(data, encrypted) {
  return bcryptP.compareAsync(data, encrypted).then(function (res) {
    if (res === false) {
      throw {
        name: 'MismatchError',
        message: 'MismatchError'
      };
    }
    return res;
  });
}

var getRounds = exports.getRounds = _bcrypt2.default.getRounds;